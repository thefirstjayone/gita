<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Random Gƒ´tƒÅ Verse</title>
  <style>
    body {
      margin: 0;
      font-family: Georgia, "Times New Roman", serif;
      background: #f5f0dc;
      background-image: radial-gradient(circle at 20% 20%, rgba(0,0,0,0.05) 0%, transparent 40%),
                        radial-gradient(circle at 80% 40%, rgba(0,0,0,0.04) 0%, transparent 35%),
                        radial-gradient(circle at 40% 80%, rgba(0,0,0,0.05) 0%, transparent 40%);
      background-size: cover;
      background-attachment: fixed;
      color: #3b2f2f;
      line-height: 1.6;
    }
    .wrap {max-width:900px; margin:0 auto; padding:28px;}
    .card {
      background: rgba(255, 255, 240, 0.85);
      border: 1px solid #d4c7a1;
      border-radius: 12px;
      padding: 24px 22px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
    }
    h1 {font-size:clamp(20px, 3.2vw, 28px); margin:0 0 8px; letter-spacing:.2px}
    .sub {color:#5c4d3b; font-size:14px; margin-bottom:18px}
    .meta{display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin:10px 0 18px}
    .pill{border:1px solid #d4c7a1; color:#5c4d3b; padding:6px 10px; border-radius:999px; font-size:12px; background:#fdfaf3}
    .sanskrit{font-size:clamp(18px, 2.8vw, 24px); line-height:1.6; margin:8px 0 10px; font-weight:bold}
    .translit{font-style:italic; color:#3e2f1c; font-size:clamp(14px, 2.4vw, 18px); line-height:1.6;}
    .meaning{margin-top:14px; font-size:clamp(15px, 2.4vw, 18px); line-height:1.7; color:#2d2112}
    .src{margin-top:8px; font-size:12px; color:#5c4d3b}
    .row{display:flex; gap:12px; flex-wrap:wrap; margin-top:18px}
    button{background:#fdfaf3; border:1px solid #c0b090; color:#3b2f2f; padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600}
    button:hover{background:#f5e9c9}
    .prime{background:#e7d9b4; border-color:#bda974}
    .muted{color:#7a6a55}
    .footer{margin-top:22px; color:#7a6a55; font-size:12px}
    .hr{height:1px; background:#d4c7a1; margin:16px 0}
    a{color:#8b6f47; text-decoration:none}
    a:hover{text-decoration:underline}
    .small{font-size:12px}
    .hidden{display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Random Bhagavad Gƒ´tƒÅ Verse</h1>
    <div class="sub">Shows chapter & verse, Sanskrit, transliteration, and a meaning with source credit.</div>

    <div class="card" id="card">
      <div class="meta">
        <span class="pill" id="cv">Ch. ‚Äî : V. ‚Äî</span>
        <span class="pill" id="chapterName">‚Äî</span>
        <span class="pill" id="countPill">‚Äî / ‚Äî</span>
      </div>
      <div class="sanskrit" id="sanskrit">Loading‚Ä¶</div>
      <div class="translit" id="translit"></div>
      <div class="meaning" id="meaning"></div>
      <div class="src" id="source"></div>

      <div class="row">
        <button class="prime" id="btnRandom">üé≤ Random</button>
        <button id="btnCopy">üìã Copy</button>
        <button id="btnShare">üîó Share</button>
        <button id="btnPrev" class="muted">‚üµ Prev</button>
        <button id="btnNext" class="muted">Next ‚ü∂</button>
      </div>

      <div class="hr"></div>
      <div class="small">Tip: Deep‚Äëlink a verse with <code>#ch-verse</code> (e.g., <code>#2-47</code>).</div>
    </div>

    <div class="footer">
      Built as a single HTML file for easy hosting (e.g., GitHub Pages). Parchment‚Äëstyle design.
    </div>
  </div>

  <script>
  const $ = sel => document.querySelector(sel);
  const cvEl=$('#cv'), nameEl=$('#chapterName'), saEl=$('#sanskrit'), tlEl=$('#translit'), enEl=$('#meaning'), srcEl=$('#source'), countPill=$('#countPill');
  const btnRandom=$('#btnRandom'), btnCopy=$('#btnCopy'), btnShare=$('#btnShare'), btnPrev=$('#btnPrev'), btnNext=$('#btnNext');
  let VERSES=[], order=[], idx=0;
  const CHAPTER_NAMES={1:'Arjuna-vi·π£ƒÅda-yoga',2:'SƒÅ·πÖkhya-yoga',3:'Karma-yoga',4:'J√±ƒÅna-Karma-SannyƒÅsa-yoga',5:'Karma-SannyƒÅsa-yoga',6:'DhyƒÅna-yoga',7:'J√±ƒÅna-Vij√±ƒÅna-yoga',8:'Ak·π£ara-Brahma-yoga',9:'RƒÅja-VidyƒÅ-RƒÅja-Guhya-yoga',10:'Vibh≈´ti-yoga',11:'Vi≈õvar≈´pa-Dar≈õana-yoga',12:'Bhakti-yoga',13:'K·π£etra-K·π£etraj√±a-VibhƒÅga-yoga',14:'Gu·πáa-Trai-VibhƒÅga-yoga',15:'Puru·π£ottama-yoga',16:'DaivƒÅsura-Sampad-VibhƒÅga-yoga',17:'≈öraddhƒÅ-Traya-VibhƒÅga-yoga',18:'Mok·π£a-SannyƒÅsa-yoga'};
  function shuffleNoRepeat(){order=[...VERSES.keys()]; for(let i=order.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[order[i],order[j]]=[order[j],order[i]];} idx=0;}
  function setHash(ch,v){location.hash=`#${ch}-${v}`;}
  function loadFromHash(){const m=location.hash.match(/#(\d+)-(\d+)/);if(!m)return false;const ch=+m[1],v=+m[2];const i=VERSES.findIndex(x=>x.ch===ch&&x.v===v);if(i>=0){idx=i;order=[...VERSES.keys()];return true;}return false;}
  function showOrHide(el,val){if(!val){el.classList.add('hidden');el.textContent='';}else{el.classList.remove('hidden');el.textContent=val;}}
  function render(i){const it=VERSES[i];if(!it)return;cvEl.textContent=`Ch. ${it.ch} : V. ${it.v}`;nameEl.textContent=it.name||CHAPTER_NAMES[it.ch]||'‚Äî';showOrHide(saEl,it.sa);showOrHide(tlEl,it.tl);showOrHide(enEl,it.en);srcEl.textContent='Source: '+(it.src||'‚Äî');countPill.textContent=`${i+1} / ${VERSES.length}`;setHash(it.ch,it.v);}
  function nextRandom(){if(order.length===0||idx>=order.length)shuffleNoRepeat();const i=order[idx++];render(i);}
  btnRandom.addEventListener('click',nextRandom);btnPrev.addEventListener('click',()=>{idx=Math.max(0,idx-2);if(idx<0)idx=0;nextRandom();});btnNext.addEventListener('click',nextRandom);
  btnCopy.addEventListener('click',async()=>{const t=`${cvEl.textContent}\n${saEl.textContent}\n${tlEl.textContent}\n\n${enEl.textContent}\n(${srcEl.textContent})`;try{await navigator.clipboard.writeText(t);btnCopy.textContent='‚úÖ Copied';setTimeout(()=>btnCopy.textContent='üìã Copy',1200);}catch(e){alert('Copy failed');}});
  btnShare.addEventListener('click',async()=>{const url=location.href;try{if(navigator.share){await navigator.share({title:'Gƒ´tƒÅ Verse',url});}else{await navigator.clipboard.writeText(url);}btnShare.textContent='‚úÖ Link ready';setTimeout(()=>btnShare.textContent='üîó Share',1200);}catch(e){}});
  async function loadVerses(){try{const r=await fetch('verses.json',{cache:'no-store'});if(!r.ok)throw new Error('HTTP '+r.status);VERSES=await r.json();if(!loadFromHash())shuffleNoRepeat();nextRandom();}catch(e){saEl.textContent='';tlEl.textContent='';enEl.textContent='Could not load verses.json.';srcEl.textContent='Source: ‚Äî';console.error('Failed to load verses.json',e);}}
  loadVerses();
  window.addEventListener('hashchange',()=>{loadFromHash();render(idx);});
  </script>
</body>
</html>
